{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { createContext, useState } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar AuthContext = createContext({\n  isSigned: false,\n  usuario: {},\n  login: function login() {},\n  logout: function logout() {}\n});\nexport function AuthProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isSigned = _useState2[0],\n      setSigned = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      usuario = _useState4[0],\n      setUsuario = _useState4[1];\n\n  function login(email, senha) {\n    fetch('http://localhost:3001/auth/login', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        e_mail: email,\n        senha: senha\n      })\n    }).then(function (res) {\n      return res.json();\n    }).then(function (result) {\n      if (result.error != null) {\n        console.log('O usuário não foi encontrado!');\n      } else {\n        setSigned(true);\n        setUsuario(result.usuario);\n      }\n    });\n  }\n\n  function logout() {\n    setSigned(false);\n    setUsuario(null);\n  }\n\n  return _jsx(AuthContext.Provider, {\n    value: {\n      isSigned: isSigned,\n      usuario: usuario,\n      login: login,\n      logout: logout\n    },\n    children: children\n  });\n}\nexport default AuthContext;","map":{"version":3,"names":["createContext","useState","AsyncStorage","AuthContext","isSigned","usuario","login","logout","AuthProvider","children","setSigned","setUsuario","email","senha","fetch","method","headers","body","JSON","stringify","e_mail","then","res","json","result","error","console","log"],"sources":["C:/expo react/mundo/src/contexts/auth.js"],"sourcesContent":["//Nosso contexto para a autenticação\r\n/*\r\nO context basicamente serve para gravar informações necessárias para vários componentes,\r\ncomo tokens de autenticação.\r\n\r\nPodemos então envolver a parte que queremos que tenha essas informações com o Context.Provider,\r\nonde todos os componentes herdam-nas.\r\n*/\r\n\r\n\r\nimport { createContext, useState } from 'react';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\n//criando o contexto e dizendo qual o formato dele (atributos que vão ser passados para ele)\r\n//O que é passado na função não é o valor default, mas sim o formato dos atributos dela.\r\n//Bom para que o react entenda quais são os attrs\r\nconst AuthContext = createContext({\r\n    isSigned:false, \r\n    usuario:{}, \r\n    login:()=>{},\r\n    logout:()=>{}\r\n});\r\n\r\n\r\n/*\r\nProvider -> Provê as informações daquele contexto\r\nExportamos o Provider com o parâmetro children, que recebe pelo react todos os componentes\r\nque vão estar dentro desse componente, e assim repassamos normalmente os valores para lá\r\n*/\r\nexport function AuthProvider({children}){\r\n\r\n    const [isSigned, setSigned] = useState(false)\r\n    const [usuario, setUsuario] = useState(null);\r\n\r\n    /*\r\n    Movemos a responsabilidade do login para o contexto, para assim \r\n    mandá-lo pelo AuthProvider\r\n    */\r\n    function login(email, senha){\r\n        fetch('http://localhost:3001/auth/login', {\r\n            method: 'POST',\r\n            headers: { \r\n                'Content-Type':'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                e_mail: email,\r\n                senha: senha\r\n            })\r\n        })\r\n        .then(res => res.json())\r\n        .then(result=>{\r\n            if(result.error != null){\r\n                console.log('O usuário não foi encontrado!');\r\n            }else{\r\n                setSigned(true);\r\n                setUsuario(result.usuario);\r\n            }\r\n        });\r\n    \r\n    }\r\n\r\n    /*\r\n    O logout apenas troca o isSigned de true pra false e o usuário fica nulo, assim no nosso componente\r\n    index.routes.js, como isSigned é false, troca da rota do App para a rota de Autenticação\r\n    */\r\n\r\n    function logout(){\r\n        setSigned(false);\r\n        setUsuario(null);\r\n    }\r\n\r\n    return (\r\n        <AuthContext.Provider value={{isSigned, usuario, login, logout}} >\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n}\r\n\r\nexport default AuthContext;"],"mappings":";AAUA,SAASA,aAAT,EAAwBC,QAAxB,QAAwC,OAAxC;AACA,OAAOC,YAAP,MAAyB,2CAAzB;;AAKA,IAAMC,WAAW,GAAGH,aAAa,CAAC;EAC9BI,QAAQ,EAAC,KADqB;EAE9BC,OAAO,EAAC,EAFsB;EAG9BC,KAAK,EAAC,iBAAI,CAAE,CAHkB;EAI9BC,MAAM,EAAC,kBAAI,CAAE;AAJiB,CAAD,CAAjC;AAaA,OAAO,SAASC,YAAT,OAAiC;EAAA,IAAVC,QAAU,QAAVA,QAAU;;EAEpC,gBAA8BR,QAAQ,CAAC,KAAD,CAAtC;EAAA;EAAA,IAAOG,QAAP;EAAA,IAAiBM,SAAjB;;EACA,iBAA8BT,QAAQ,CAAC,IAAD,CAAtC;EAAA;EAAA,IAAOI,OAAP;EAAA,IAAgBM,UAAhB;;EAMA,SAASL,KAAT,CAAeM,KAAf,EAAsBC,KAAtB,EAA4B;IACxBC,KAAK,CAAC,kCAAD,EAAqC;MACtCC,MAAM,EAAE,MAD8B;MAEtCC,OAAO,EAAE;QACL,gBAAe;MADV,CAF6B;MAKtCC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;QACjBC,MAAM,EAAER,KADS;QAEjBC,KAAK,EAAEA;MAFU,CAAf;IALgC,CAArC,CAAL,CAUCQ,IAVD,CAUM,UAAAC,GAAG;MAAA,OAAIA,GAAG,CAACC,IAAJ,EAAJ;IAAA,CAVT,EAWCF,IAXD,CAWM,UAAAG,MAAM,EAAE;MACV,IAAGA,MAAM,CAACC,KAAP,IAAgB,IAAnB,EAAwB;QACpBC,OAAO,CAACC,GAAR,CAAY,+BAAZ;MACH,CAFD,MAEK;QACDjB,SAAS,CAAC,IAAD,CAAT;QACAC,UAAU,CAACa,MAAM,CAACnB,OAAR,CAAV;MACH;IACJ,CAlBD;EAoBH;;EAOD,SAASE,MAAT,GAAiB;IACbG,SAAS,CAAC,KAAD,CAAT;IACAC,UAAU,CAAC,IAAD,CAAV;EACH;;EAED,OACI,KAAC,WAAD,CAAa,QAAb;IAAsB,KAAK,EAAE;MAACP,QAAQ,EAARA,QAAD;MAAWC,OAAO,EAAPA,OAAX;MAAoBC,KAAK,EAALA,KAApB;MAA2BC,MAAM,EAANA;IAA3B,CAA7B;IAAA,UACKE;EADL,EADJ;AAKH;AAED,eAAeN,WAAf"},"metadata":{},"sourceType":"module"}